################################################################################
### VARIABLES                                                                ###
################################################################################

BUILD_DIR?=.
BUILD_TYPE?=Release
INSTALL_DIR?=.

################################################################################
### ALL                                                                      ###
################################################################################

all: configure build

################################################################################
### CONFIGURE                                                                ###
################################################################################

configure:
	@echo "Configuring..."
	@cmake -G "Ninja" -DCMAKE_BUILD_TYPE=$(BUILD_TYPE) -B $(BUILD_DIR)/_build/$(BUILD_TYPE) -S .
	@echo "Done."

################################################################################
### BUILD                                                                    ###
################################################################################

build:
	@echo "Building..."
	@cmake --build $(BUILD_DIR)/_build/$(BUILD_TYPE)
	@echo "Done."

################################################################################
### INSTALL                                                                  ###
################################################################################

install:
	@echo "Installing..."
	@cmake --install $(BUILD_DIR)/_build/$(BUILD_TYPE) --prefix $(INSTALL_DIR)/bin/$(BUILD_TYPE)
	@echo "Done."

################################################################################
### CLEAN                                                                    ###
################################################################################

clean:
	@echo "Cleaning..."
	@rm -rf $(BUILD_DIR)/_build
	@rm -rf $(INSTALL_DIR)/bin
	@echo "Done."

################################################################################
### FORMAT                                                                   ###
################################################################################

format:
	@echo "Formatting..."
	@clang-format -i `find . -name '*.h' -o -name '*.c' -not -path "./_build/*"`
	@echo "Done."